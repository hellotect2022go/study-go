# Step 6: 실전 프로젝트 - 로그 파일 분석기

## 🎯 프로젝트 목표
대용량 로그 파일을 스트리밍 방식으로 분석하는 완전한 프로그램 구현

## 📋 프로젝트 요구사항

### 기능 명세
1. **로그 레벨 통계**
   - ERROR, WARNING, INFO 개수 세기
   - 전체 대비 비율 계산

2. **IP 주소 분석**
   - 고유 IP 추출
   - 빈도수 계산
   - 가장 빈번한 IP 찾기

3. **실시간 진행률**
   - 1000줄마다 진행률 표시
   - 처리 속도 표시

4. **에러 메시지 수집**
   - 에러 발생 줄 저장 (최대 10개)
   - 샘플 제공

5. **리포트 생성**
   - 콘솔 출력
   - 텍스트 파일 저장

## 🏗️ 프로그램 구조

### 주요 컴포넌트

#### 1. LogStats - 통계 구조체
```
├── TotalLines (총 줄 수)
├── ErrorCount (에러 수)
├── WarningCount (경고 수)
├── InfoCount (정보 수)
├── UniqueIPs (map[string]int)
└── ErrorMessages ([]string)
```

#### 2. LogAnalyzer - 분석기
```
├── stats (*LogStats)
├── errorRegex (*regexp.Regexp)
├── warningRegex (*regexp.Regexp)
└── ipRegex (*regexp.Regexp)
```

### 메서드 구조
```
LogAnalyzer
├── NewLogAnalyzer() - 생성자
├── AnalyzeFile(filename) - 파일 분석
├── processLine(line) - 한 줄 처리
├── PrintReport() - 콘솔 출력
└── SaveReport(filename) - 파일 저장
```

## 🔍 핵심 기술 스택

### 1. 스트리밍 처리
- `bufio.Reader` - 줄 단위 읽기
- 메모리 사용량 일정 유지
- 파일 크기 무관

### 2. 정규표현식
```go
errorRegex := regexp.MustCompile(`ERROR|Error|error`)
ipRegex := regexp.MustCompile(`\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b`)
```

### 3. 진행률 계산
```
처리한 바이트 / 전체 크기 * 100
```

### 4. 통계 관리
- 맵으로 빈도 관리
- 슬라이스로 샘플 저장

## 📊 처리 플로우

```
1. 파일 열기
   ↓
2. 파일 크기 확인 (진행률용)
   ↓
3. bufio.Reader 생성
   ↓
4. 반복:
   ├─ 한 줄 읽기
   ├─ 패턴 매칭
   ├─ 통계 업데이트
   ├─ 진행률 표시 (1000줄마다)
   └─ EOF까지
   ↓
5. 리포트 생성
   ↓
6. 파일 저장
```

## 🎨 출력 예시

### 콘솔 출력
```
로그 파일 분석 시작...
진행률: 10.5% (1000 줄 처리)
진행률: 21.3% (2000 줄 처리)
...
분석 완료! 소요 시간: 2.3s

============================================================
📊 로그 분석 보고서
============================================================

총 라인 수: 9543
에러 수: 142 (1.49%)
경고 수: 523 (5.48%)
정보 수: 8878 (93.03%)

고유 IP 주소 수: 234
가장 빈번한 IP: 192.168.1.100 (456회)

최근 에러 메시지 샘플:
1. [ERROR] Database connection failed: timeout
2. [ERROR] Failed to read file: permission denied
...
```

## 🎓 실습 과제

### 과제 1: 기본 분석기 구현

**요구사항**:
1. LogStats 구조체 정의
2. LogAnalyzer 구조체 정의
3. 줄 단위 읽기 구현
4. 간단한 통계 출력

### 과제 2: 정규표현식 매칭

**추가 기능**:
1. ERROR/WARNING/INFO 패턴 매칭
2. IP 주소 추출
3. 빈도 계산

**정규표현식 힌트**:
```
에러: ERROR|Error|error
IP: \b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b
날짜: \d{4}-\d{2}-\d{2}
```

### 과제 3: 진행률 표시

**요구사항**:
1. 파일 크기 확인
2. 처리한 바이트 누적
3. 퍼센트 계산
4. 1000줄마다 출력

**출력 형식**:
```
\r진행률: 45.2% (4500 줄 처리)
```

### 과제 4: 리포트 생성

**요구사항**:
1. 보기 좋은 콘솔 출력
2. 텍스트 파일 저장
3. 처리 시간 표시

## 🚀 성능 최적화

### 메모리 사용
- ❌ 전체 로드: 10GB 파일 = 10GB 메모리
- ✅ 스트리밍: 10GB 파일 = 1MB 메모리

### 처리 속도
| 파일 크기 | 처리 시간 |
|---------|---------|
| 100MB | 2초 |
| 1GB | 20초 |
| 10GB | 200초 (3분) |

### 병목 지점
1. **디스크 I/O** - SSD 권장
2. **정규표현식** - 컴파일 재사용
3. **맵 조회** - O(1) 평균

## 🔧 확장 아이디어

### Level 1: 기본 확장
- [ ] JSON 형식 리포트
- [ ] CSV 형식 리포트
- [ ] 날짜별 통계
- [ ] 시간대별 통계

### Level 2: 고급 확장
- [ ] 실시간 스트리밍 (tail -f)
- [ ] 여러 파일 동시 처리
- [ ] 웹 대시보드
- [ ] 알림 기능 (에러 임계치)

### Level 3: 프로덕션
- [ ] 플러그인 시스템
- [ ] 커스텀 패턴 설정
- [ ] 분산 처리
- [ ] 압축 파일 지원 (gzip)

## 📈 테스트 데이터 생성

### 샘플 로그 생성기
```
줄 수: 10,000 ~ 1,000,000
에러율: 1% ~ 5%
경고율: 5% ~ 10%
고유 IP: 100 ~ 1000
```

### 생성 패턴
```
[타임스탬프] [레벨] [IP] 메시지
```

**예시**:
```
2024-01-15 10:30:15 INFO 192.168.1.100 User login successful
2024-01-15 10:30:20 ERROR 10.0.0.5 Database connection timeout
```

## 🔑 핵심 학습 포인트

### 1. 스트리밍 처리
```go
scanner := bufio.NewScanner(file)
for scanner.Scan() {
    processLine(scanner.Text())
}
```

### 2. 상태 관리
- 구조체로 통계 관리
- 맵으로 빈도 계산

### 3. 정규표현식
- 패턴 매칭으로 분석
- 컴파일 한 번, 재사용 여러 번

### 4. 진행률 표시
- 사용자 경험 개선
- 처리 시간 예측 가능

### 5. 리포트 생성
- 데이터 시각화
- 의사결정 지원

## ✅ 완성 체크리스트

### 기능
- [ ] 파일 읽기 (스트리밍)
- [ ] 레벨별 통계
- [ ] IP 주소 추출
- [ ] 진행률 표시
- [ ] 콘솔 리포트
- [ ] 파일 리포트

### 성능
- [ ] 1GB 파일 처리 가능
- [ ] 메모리 사용량 일정
- [ ] 처리 시간 표시

### 안정성
- [ ] 에러 처리
- [ ] 리소스 정리 (defer)
- [ ] 빈 파일 처리
- [ ] 큰 라인 처리

## 🎉 프로젝트 완료 후

이 프로젝트를 완성하면:
- ✅ 실무 레벨 Go 프로그램 작성 능력
- ✅ 대용량 데이터 처리 경험
- ✅ 포트폴리오에 추가 가능
- ✅ 실전 문제 해결 능력

## ➡️ 다음 단계

**Step 7: 성능 최적화**
- 버퍼 크기 최적화
- 병렬 처리
- 메모리 풀 활용

